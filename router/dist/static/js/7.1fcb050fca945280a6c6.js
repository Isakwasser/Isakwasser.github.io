webpackJsonp([7],{k5iw:function(t,e,i){t.exports=i.p+"static/media/sound_sm.e069115.wav"},pXK8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});i("504h");var n={data:function(){return{windowWidth:.01,fs:void 0}},methods:{step1:function(){var t=this,e=new(AudioContext||webkitAudioContext),i=new XMLHttpRequest;i.open("GET",this.$refs.audio.src,!0),i.responseType="arraybuffer",i.onload=function(){e.decodeAudioData(i.response,function(e){var i=e.getChannelData(0);t.showSpectrogramByBytes(i,e.sampleRate)},function(t){console.log("Decode error: "+t)})},i.send()},showSpectrogramByBytes:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"spectrogram";console.log(e);var s=document.getElementById(n);s.style.position="relative",s.width=t.length/e/this.windowWidth*2,s.height=e*this.windowWidth;var a=s.getContext("2d");a.clearRect(0,0,s.width,s.height),a.fillStyle="rgb(0, 0, 0)",a.fillRect(0,0,s.width,s.height);!function n(o){for(var r=function(t,e){for(var i={amplitude:[],frequency:[],Re:[],Im:[]},n=t.length,s=1/Math.sqrt(n),a=[],o=[],r=0;r<n;r++){for(var c=0,l=0,u=0;u<n;u++)c+=t[u]*Math.cos(2*Math.PI/n*u*r),l+=t[u]*Math.sin(2*Math.PI/n*u*r);a[r]=s*c,o[r]=-s*l}i.Re=a,i.Im=o;for(var d=0;d<i.Im.length;d++)i.amplitude.push(Math.sqrt(i.Re[d]*i.Re[d]+i.Im[d]*i.Im[d])),i.frequency.push(d*e/i.Im.length);return i}(t.slice(o*e*i.windowWidth,(o+1)*e*i.windowWidth),e),c=[],l=[],u=0;u<r.amplitude.length/2;u++){var d=(Math.log(r.amplitude[u])+10)/20;c.push(d),l.push(r.frequency[u])}for(var v=2*o,h=s.height,f=0;f<l.length;f++)a.fillStyle="rgba(255, 255, 255,"+c[f]+")",a.fillRect(v,h,3,2),h-=2;(o+1)*e*i.windowWidth<t.length&&setTimeout(n,0,o+1)}(0)},getSpectrogram:function(){var t=this,e=new(AudioContext||webkitAudioContext),i=new XMLHttpRequest;i.open("GET",this.$refs.audio.src,!0),i.responseType="arraybuffer",i.onload=function(){e.decodeAudioData(i.response,function(e){t.initAudioBuffer=e;var i=e.getChannelData(0);console.log("float32Array",i)},function(t){console.log("Decode error: "+t)})},i.send()},playFloat32Array:function(t){for(var e=new(window.AudioContext||window.webkitAudioContext),i=(t.getChannelData(0),0);i<t.length;i++);var n=e.createBufferSource();n.buffer=t,n.connect(e.destination),n.start(),this.$refs.stop.onclick=function(){n.stop()}},test:function(){var t=new AudioContext,e=new Audio;e.src="/static/media/sound.wav",e.autoplay=!0,e.preload="auto";var i=t.createMediaElementSource(e),n=t.createAnalyser();n.fftSize=8192;var s=n.frequencyBinCount,a=new Uint8Array(s);i.connect(n),n.connect(t.destination);var o=document.getElementById("spectrogram");o.style.position="relative",o.width=window.innerWidth,o.height=s;var r=o.getContext("2d");r.clearRect(0,0,o.width,o.height),r.fillStyle="rgb(0, 0, 0)",r.fillRect(0,0,o.width,o.height),function t(){var e=r.getImageData(0,0,o.width,o.height);n.getByteFrequencyData(a),r.fillStyle="rgb(0, 0, 0)",r.fillRect(0,0,o.width,o.height),r.putImageData(e,2,0);for(var i=o.height,c=0;c<s;c++){var l=a[c]/255;r.fillStyle="rgba(255, 255, 255,"+l+")",r.fillRect(0,i,4,1),i-=1}requestAnimationFrame(t)}()},filter:function(){var t=new(AudioContext||webkitAudioContext),e=t.createMediaElementSource(this.$refs.audio),i=t.createBiquadFilter();e.connect(i),i.connect(t.destination),i.frequency.value=1e4,i.gain.value=30,i.type="highpass",i.frequency.setValueAtTime(0,t.currentTime),i.frequency.linearRampToValueAtTime(120,t.currentTime+10),console.log("filter end")},step2:function(){var t=this,e=new(AudioContext||webkitAudioContext),i=new XMLHttpRequest;i.open("GET",this.$refs.audio2.src,!0),i.responseType="arraybuffer",i.onload=function(){e.decodeAudioData(i.response,function(e){var i=e.getChannelData(0);t.filterButterworth(i),t.showSpectrogramByBytes(i,e.sampleRate,"spectrogram2"),t.playFloat32Array(e)},function(t){console.log("Decode error: "+t)})},i.send()},filterButterworth:function(t){for(var e=t.slice(0),i=void 0,n=[1,3,3,1],s=[960001,-1343997,576003,-191999],a=0;a<t.length;a++){i=0;for(var o=0;o<=3;o++)a-o>=0&&(i+=s[o]*e[a-o]);for(var r=1;r<=3;r++)a-r>=0&&(i-=n[r]*t[a-r]);t[a]=i/960001}return console.log(t),t}},mounted:function(){}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"appDigitalInit"},[n("div",{staticClass:"appDigital_S07"},[n("h2",{staticClass:"text-center"},[t._v("Самостоятельная работа №7")]),t._v(" "),n("div",{staticClass:"step"},[t._m(0),t._v(" "),n("div",{staticClass:"step__content"},[n("div",{staticClass:"step__descryption"},[t._v("Аудиофайл")]),t._v(" "),n("div",{staticClass:"step__action"},[n("audio",{ref:"audio",attrs:{controls:"",src:i("k5iw")}},[t._v("\n            Тег audio не поддерживается вашим браузером.\n          ")])])])]),t._v(" "),n("div",{staticClass:"step"},[t._m(1),t._v(" "),n("div",{staticClass:"step__content"},[n("div",{staticClass:"step__descryption"},[n("button",{on:{click:t.step1}},[t._v("\n            Получить спектрограмму c временным разрешением "+t._s(t.windowWidth)+"с\n          ")])]),t._v(" "),t._m(2)])]),t._v(" "),n("div",{staticClass:"step"},[t._m(3),t._v(" "),n("div",{staticClass:"step__content"},[n("div",{staticClass:"step__descryption"},[t._v("Аудиофайл")]),t._v(" "),n("div",{staticClass:"step__action"},[n("audio",{ref:"audio2",attrs:{controls:"",src:i("k5iw")}},[t._v("\n            Тег audio не поддерживается вашим браузером.\n          ")])])])]),t._v(" "),n("div",{staticClass:"step"},[t._m(4),t._v(" "),n("div",{staticClass:"step__content"},[n("div",{staticClass:"step__descryption"},[n("button",{on:{click:t.step2}},[t._v("\n            Фильтр, спектрограмма, воспроизведение\n          ")]),t._v(" "),n("button",{ref:"stop"},[t._v("Остановить воспроизведение")])]),t._v(" "),t._m(5)])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__num"},[e("div",{staticClass:"num"},[this._v("1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__num"},[e("div",{staticClass:"num"},[this._v("2")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__action"},[e("canvas",{attrs:{id:"spectrogram"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__num"},[e("div",{staticClass:"num"},[this._v("3")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__num"},[e("div",{staticClass:"num"},[this._v("4")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"step__action"},[e("canvas",{attrs:{id:"spectrogram2"}})])}]};var a=i("VU/8")(n,s,!1,function(t){i("um3I")},null,null);e.default=a.exports},um3I:function(t,e){}});
//# sourceMappingURL=7.1fcb050fca945280a6c6.js.map